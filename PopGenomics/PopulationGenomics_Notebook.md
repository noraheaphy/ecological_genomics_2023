# Population Genomics Lab Notebook

## Author: Nora Heaphy

### Affiliation: University of Vermont, Dept. of Plant Biology

### E-mail contact: [nora.heaphy\@uvm.edu](mailto:nora.heaphy@uvm.edu){.email}

### Start Date: Sept. 11, 2023

### End Date:

### Project Description: This notebook will document my workflow on the bioinformatics of the Population Genomics section of the Fall 2023 Ecological Genomics course.

# Table of Contents:

-   [Entry 1: 2023-09-11](#id-section1)
-   [Entry 2: 2023-09-13](#id-section2)
-   [Entry 3: 2023-09-18](#id-section3)
-   [Entry 4: 2023-09-20](#id-section4)
-   [Entry 5: 2023-09-25](#id-section5)

------------------------------------------------------------------------

<div id='id-section1'/>

### Entry 1: 2023-09-11.

-   We reviewed the red spruce study system and the exome capture data.
-   We discussed the structure of fastq files (DNA sequences, Q-scores).
-   Using the program FastQC, we analyzed the quality of the sequencing runs for one file.

------------------------------------------------------------------------

<div id='id-section2'/>

### Entry 2: 2023-09-13.

-   After discussing FastQC results, we saw good quality sequence data for most of the read length.
-   The initial 5 bp or so had more variable base frequencies, and the very end of the reads had slightly lower Q-scores.
-   Based on this, we set up an analysis to trim the reads using the 'fastp' program.
-   We ran the bash script 'fastp.sh' for this.
-   We looked at the html files produced by 'fastp' and compared pre- and post-trimming. Things looked good!
-   We ended the day be setting up our read mapping of the trimmed and cleaned reads using 'bwa'.

------------------------------------------------------------------------

<div id='id-section3'/>

### Entry 3: 2023-09-18.

-  We checked the SAM files we outputted after the read mapping last week and learned what the SAM FLAGs mean.
-  We used sambamba to process our mapped reads, converting the SAM alignment file to a binary BAM file, removing PCR duplicate reads, and indexing and sorting the BAM file.
-  We began editing a bash script to run samtools, which will calculate mapping stats and produce a summary of how well our reads mapped.

------------------------------------------------------------------------

<div id='id-section4'/>

### Entry 4: 2023-09-20.
-  We calculated mapping stats with the 'bash_stats.sh' script.
-  Used 'ANGSD.sh' script to estimate genotype likelihoods and allele frequencies after filtering to minimize noise and then use GLs to estimate the site frequency spectrum (SFS), nucleotide diversities, and neutrality stats We used a genotype likelihood approach because read depth was low.

------------------------------------------------------------------------

<div id='id-section5'/>

### Entry 5: 2023-09-25.
-  We estimated the site frequency spectrum (SFS) using the genotype likelihoods generated by ANGSD and calculated diversity statistics (theta W, theta pi, Tajima's D, etc).
-  We then summarized and visualized the diversity stats in R.
